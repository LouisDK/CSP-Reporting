**********************
PowerShell transcript start
Start time: 20250404094542
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 09:45:42] [INFO] Starting CSP Reporting process at 04/04/2025 09:45:42
[2025-04-04 09:45:42] [INFO] Processing tenant: Chartered Group
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:269:21
Line |
 269 |                      Connect-CSPTenant @authParams
     |                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Connect-CSPTenant: Certificate password is required for certificate authentication
Connect-CSPTenant: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:269:21
Line |
 269 |                      Connect-CSPTenant @authParams
     |                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Connect-CSPTenant: Certificate password is required for certificate authentication

[2025-04-04 09:45:42] [ERROR] Authentication failed for tenant Chartered Group: Error in Connect-CSPTenant: Certificate password is required for certificate authentication
[2025-04-04 09:45:42] [INFO] Processing tenant: Harith
PS>TerminatingError(Connect-CSPTenant): "Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString"."
>> TerminatingError(Connect-CSPTenant): "Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString"."
[2025-04-04 09:45:42] [ERROR] Non-retryable error in Authenticate to tenant Harith. Error: Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString".
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:268:31
Line |
 268 |                  $authResult = Invoke-CSPWithRetry -ScriptBlock {
     |                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Invoke-CSPWithRetry: Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString".
Invoke-CSPWithRetry: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:268:31
Line |
 268 |                  $authResult = Invoke-CSPWithRetry -ScriptBlock {
     |                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Invoke-CSPWithRetry: Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString".

PS>TerminatingError(Connect-CSPTenant): "Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString"."
[2025-04-04 09:45:42] [ERROR] Error processing tenant Harith: Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString".
True
[2025-04-04 09:45:42] [INFO] CSP Reporting process completed at 04/04/2025 09:45:42
**********************
PowerShell transcript end
End time: 20250404094542
**********************
**********************
PowerShell transcript start
Start time: 20250404094903
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 09:49:03] [INFO] Starting CSP Reporting process at 04/04/2025 09:49:03
[2025-04-04 09:49:03] [INFO] Processing tenant: Harith
PS>TerminatingError(Connect-CSPTenant): "Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString"."
>> TerminatingError(Connect-CSPTenant): "Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString"."
[2025-04-04 09:49:03] [ERROR] Non-retryable error in Authenticate to tenant Harith. Error: Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString".
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:268:31
Line |
 268 |                  $authResult = Invoke-CSPWithRetry -ScriptBlock {
     |                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Invoke-CSPWithRetry: Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString".
Invoke-CSPWithRetry: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:268:31
Line |
 268 |                  $authResult = Invoke-CSPWithRetry -ScriptBlock {
     |                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Invoke-CSPWithRetry: Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString".

PS>TerminatingError(Connect-CSPTenant): "Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString"."
[2025-04-04 09:49:03] [ERROR] Error processing tenant Harith: Cannot process argument transformation on parameter 'ClientSecret'. Cannot convert the value of type "System.String" to type "System.Security.SecureString".
True
[2025-04-04 09:49:03] [INFO] CSP Reporting process completed at 04/04/2025 09:49:03
**********************
PowerShell transcript end
End time: 20250404094903
**********************
**********************
PowerShell transcript start
Start time: 20250404095418
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 09:54:18] [INFO] Starting CSP Reporting process at 04/04/2025 09:54:18
[2025-04-04 09:54:18] [INFO] Processing tenant: Harith
PS>TerminatingError(Connect-MgGraph): "Cannot bind parameter 'ClientSecretCredential'. Cannot convert the value of type "System.Security.SecureString" to type "System.Management.Automation.PSCredential"."
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:274:21
Line |
 274 |                      Connect-CSPTenant @authParams
     |                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Client secret authentication failed: Cannot bind parameter 'ClientSecretCredential'. Cannot convert the value of type "System.Security.SecureString" to type "System.Management.Automation.PSCredential".
Connect-CSPTenant: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:274:21
Line |
 274 |                      Connect-CSPTenant @authParams
     |                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Client secret authentication failed: Cannot bind parameter 'ClientSecretCredential'. Cannot convert the value of type "System.Security.SecureString" to type
     | "System.Management.Automation.PSCredential".

[2025-04-04 09:54:18] [ERROR] Authentication failed for tenant Harith: Client secret authentication failed: Cannot bind parameter 'ClientSecretCredential'. Cannot convert the value of type "System.Security.SecureString" to type "System.Management.Automation.PSCredential".
[2025-04-04 09:54:18] [INFO] CSP Reporting process completed at 04/04/2025 09:54:18
**********************
PowerShell transcript end
End time: 20250404095418
**********************
**********************
PowerShell transcript start
Start time: 20250404101629
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 10:16:29] [INFO] Starting CSP Reporting process at 04/04/2025 10:16:29
[2025-04-04 10:16:29] [INFO] Processing tenant: Harith
PS>TerminatingError(Connect-MgGraph): "Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided."
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:277:21
Line |
 277 |                      Connect-CSPTenant @authParams
     |                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Client secret authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided.
Connect-CSPTenant: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:277:21
Line |
 277 |                      Connect-CSPTenant @authParams
     |                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Client secret authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of
     | parameters were provided.

[2025-04-04 10:16:29] [ERROR] Authentication failed for tenant Harith: Client secret authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided.
[2025-04-04 10:16:29] [INFO] CSP Reporting process completed at 04/04/2025 10:16:29
**********************
PowerShell transcript end
End time: 20250404101629
**********************
**********************
PowerShell transcript start
Start time: 20250404101731
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 10:17:31] [INFO] Starting CSP Reporting process at 04/04/2025 10:17:31
[2025-04-04 10:17:31] [INFO] Processing tenant: Harith
[2025-04-04 10:17:31] [DEBUG] Auth parameters: {
  "ClientId": "08616068-6348-4055-9c17-f04d332f23fc",
  "AuthMethod": "ClientSecret",
  "TenantId": "harith.onmicrosoft.com",
  "ClientSecretCredential": {
    "UserName": "08616068-6348-4055-9c17-f04d332f23fc",
    "Password": {
      "Length": 40
    }
  }
}
PS>TerminatingError(): "A Using variable cannot be retrieved. A Using variable can be used only with Invoke-Command, Start-Job, or InlineScript in the script workflow. When it is used with Invoke-Command, the Using variable is valid only if the script block is invoked on a remote computer."
[2025-04-04 10:17:31] [ERROR] Non-retryable error in Authenticate to tenant Harith. Error: A Using variable cannot be retrieved. A Using variable can be used only with Invoke-Command, Start-Job, or InlineScript in the script workflow. When it is used with Invoke-Command, the Using variable is valid only if the script block is invoked on a remote computer.
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:279:31
Line |
 279 |                  $authResult = Invoke-CSPWithRetry -ScriptBlock {
     |                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Invoke-CSPWithRetry: A Using variable cannot be retrieved. A Using variable can be used only with Invoke-Command, Start-Job, or InlineScript in the script workflow. When it is used with Invoke-Command, the Using variable is valid only if the script block is invoked on a remote computer.
Invoke-CSPWithRetry: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:279:31
Line |
 279 |                  $authResult = Invoke-CSPWithRetry -ScriptBlock {
     |                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Invoke-CSPWithRetry: A Using variable cannot be retrieved. A Using variable can be used only with Invoke-Command, Start-Job, or InlineScript in the script workflow. When it is used
     | with Invoke-Command, the Using variable is valid only if the script block is invoked on a remote computer.

PS>TerminatingError(): "A Using variable cannot be retrieved. A Using variable can be used only with Invoke-Command, Start-Job, or InlineScript in the script workflow. When it is used with Invoke-Command, the Using variable is valid only if the script block is invoked on a remote computer."
[2025-04-04 10:17:31] [ERROR] Error processing tenant Harith: A Using variable cannot be retrieved. A Using variable can be used only with Invoke-Command, Start-Job, or InlineScript in the script workflow. When it is used with Invoke-Command, the Using variable is valid only if the script block is invoked on a remote computer.
True
[2025-04-04 10:17:31] [INFO] CSP Reporting process completed at 04/04/2025 10:17:31
**********************
PowerShell transcript end
End time: 20250404101731
**********************
**********************
PowerShell transcript start
Start time: 20250404102159
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 10:21:59] [INFO] Starting CSP Reporting process at 04/04/2025 10:21:59
[2025-04-04 10:21:59] [INFO] Processing tenant: Harith
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:277:21
Line |
 277 |                      Connect-CSPTenant @args
     |                      ~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Connect-CSPTenant: Certificate path is invalid or not provided
Connect-CSPTenant: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:277:21
Line |
 277 |                      Connect-CSPTenant @args
     |                      ~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Connect-CSPTenant: Certificate path is invalid or not provided

[2025-04-04 10:23:48] [ERROR] Authentication failed for tenant Harith: Error in Connect-CSPTenant: Certificate path is invalid or not provided
[2025-04-04 10:23:48] [INFO] CSP Reporting process completed at 04/04/2025 10:23:48
**********************
PowerShell transcript end
End time: 20250404102348
**********************
**********************
PowerShell transcript start
Start time: 20250404102900
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 10:29:00] [INFO] Starting CSP Reporting process at 04/04/2025 10:29:00
[2025-04-04 10:29:00] [INFO] Processing tenant: Harith
[2025-04-04 10:29:00] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:280:21
Line |
 280 |                      Connect-CSPTenant @args
     |                      ~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Connect-CSPTenant: Certificate path is invalid or not provided
Connect-CSPTenant: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:280:21
Line |
 280 |                      Connect-CSPTenant @args
     |                      ~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Connect-CSPTenant: Certificate path is invalid or not provided

[2025-04-04 10:29:30] [ERROR] Authentication failed for tenant Harith: Error in Connect-CSPTenant: Certificate path is invalid or not provided
[2025-04-04 10:29:30] [INFO] CSP Reporting process completed at 04/04/2025 10:29:30
**********************
PowerShell transcript end
End time: 20250404102930
**********************
**********************
PowerShell transcript start
Start time: 20250404103106
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 10:31:06] [INFO] Starting CSP Reporting process at 04/04/2025 10:31:06
[2025-04-04 10:31:06] [INFO] Processing tenant: Harith
[2025-04-04 10:31:06] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-04 10:31:06] [DEBUG] Auth parameters: {
  "TenantId": "harith.onmicrosoft.com",
  "ClientId": "08616068-6348-4055-9c17-f04d332f23fc",
  "AuthMethod": "ClientSecret",
  "Verbose": true,
  "ClientSecretCredential": {
    "UserName": "08616068-6348-4055-9c17-f04d332f23fc",
    "Password": {
      "Length": 40
    }
  }
}
[2025-04-04 10:31:06] [DEBUG] Attempting direct authentication...
VERBOSE: Connecting to tenant harith.onmicrosoft.com using ClientSecret authentication
VERBOSE: Connecting with ClientSecretCredential: TenantId=harith.onmicrosoft.com, ClientId=08616068-6348-4055-9c17-f04d332f23fc
PS>TerminatingError(Connect-MgGraph): "Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided."
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:284:35
Line |
 284 |                      $authResult = Connect-CSPTenant @authParams
     |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Client secret authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided.
Connect-CSPTenant: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:284:35
Line |
 284 |                      $authResult = Connect-CSPTenant @authParams
     |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Client secret authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of
     | parameters were provided.

[2025-04-04 10:31:06] [DEBUG] Direct authentication successful
[2025-04-04 10:31:06] [ERROR] Authentication failed for tenant Harith: Client secret authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided.
[2025-04-04 10:31:06] [INFO] CSP Reporting process completed at 04/04/2025 10:31:06
**********************
PowerShell transcript end
End time: 20250404103106
**********************
**********************
PowerShell transcript start
Start time: 20250404103238
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 10:32:38] [INFO] Starting CSP Reporting process at 04/04/2025 10:32:38
[2025-04-04 10:32:38] [INFO] Processing tenant: Harith
[2025-04-04 10:32:38] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-04 10:32:38] [DEBUG] Auth parameters: {
  "TenantId": "harith.onmicrosoft.com",
  "ClientId": "08616068-6348-4055-9c17-f04d332f23fc",
  "AuthMethod": "ClientSecret",
  "Verbose": true,
  "ClientSecretCredential": {
    "UserName": "08616068-6348-4055-9c17-f04d332f23fc",
    "Password": {
      "Length": 40
    }
  }
}
[2025-04-04 10:32:38] [DEBUG] Attempting direct authentication...
VERBOSE: Connecting to tenant harith.onmicrosoft.com using ClientSecret authentication
VERBOSE: Connecting with Client Secret: TenantId=harith.onmicrosoft.com, ClientId=08616068-6348-4055-9c17-f04d332f23fc
PS>TerminatingError(Connect-MgGraph): "Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided."
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:284:35
Line |
 284 |                      $authResult = Connect-CSPTenant @authParams
     |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Client secret authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided.
Connect-CSPTenant: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:284:35
Line |
 284 |                      $authResult = Connect-CSPTenant @authParams
     |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Client secret authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of
     | parameters were provided.

[2025-04-04 10:32:38] [DEBUG] Direct authentication successful
[2025-04-04 10:32:38] [ERROR] Authentication failed for tenant Harith: Client secret authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided.
[2025-04-04 10:32:38] [INFO] CSP Reporting process completed at 04/04/2025 10:32:38
**********************
PowerShell transcript end
End time: 20250404103238
**********************
**********************
PowerShell transcript start
Start time: 20250404103339
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 10:33:39] [INFO] Starting CSP Reporting process at 04/04/2025 10:33:39
[2025-04-04 10:33:39] [INFO] Processing tenant: Harith
[2025-04-04 10:33:39] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-04 10:33:39] [DEBUG] Attempting direct authentication with Connect-MgGraph...
PS>TerminatingError(Connect-MgGraph): "Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided."
[2025-04-04 10:33:39] [ERROR] Direct authentication with Connect-MgGraph failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided.
[2025-04-04 10:33:39] [ERROR] Authentication failed for tenant Harith: Direct authentication with Connect-MgGraph failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided.
[2025-04-04 10:33:39] [INFO] CSP Reporting process completed at 04/04/2025 10:33:39
**********************
PowerShell transcript end
End time: 20250404103339
**********************
**********************
PowerShell transcript start
Start time: 20250404112004
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250404T083338\window1\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-29136-260780.json' -FeatureFlags @() 
Process ID: 23548
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-04 11:20:04] [INFO] Starting CSP Reporting process at 04/04/2025 11:20:04
[2025-04-04 11:20:04] [INFO] Processing tenant: Harith
[2025-04-04 11:20:04] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-04 11:20:04] [DEBUG] Attempting direct authentication with Connect-MgGraph using ClientId method...
[2025-04-04 11:20:04] [DEBUG] Connecting with ClientId=08616068-6348-4055-9c17-f04d332f23fc, TenantId=harith.onmicrosoft.com
**********************
PowerShell transcript start
Start time: 20250410131115
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 13:11:16] [INFO] Starting CSP Reporting process at 04/10/2025 13:11:16
[2025-04-10 13:11:16] [INFO] Processing tenant: Chartered Group
[2025-04-10 13:11:16] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-10 13:11:16] [DEBUG] Attempting authentication with Connect-CSPTenant...
PS>TerminatingError(Connect-CSPTenant): "Cannot process argument transformation on parameter 'CertificatePassword'. Cannot convert the value of type "System.String" to type "System.Security.SecureString"."
[2025-04-10 13:11:16] [ERROR] Authentication with Connect-CSPTenant failed: Cannot process argument transformation on parameter 'CertificatePassword'. Cannot convert the value of type "System.String" to type "System.Security.SecureString".
[2025-04-10 13:11:16] [ERROR] Authentication failed for tenant Chartered Group: Authentication with Connect-CSPTenant failed: Cannot process argument transformation on parameter 'CertificatePassword'. Cannot convert the value of type "System.String" to type "System.Security.SecureString".
[2025-04-10 13:11:16] [INFO] CSP Reporting process completed at 04/10/2025 13:11:16
**********************
PowerShell transcript end
End time: 20250410131116
**********************
**********************
PowerShell transcript start
Start time: 20250410131304
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 13:13:04] [INFO] Starting CSP Reporting process at 04/10/2025 13:13:04
[2025-04-10 13:13:04] [INFO] Processing tenant: Chartered Group
[2025-04-10 13:13:04] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-10 13:13:04] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant charteredgroup.onmicrosoft.com using Certificate authentication
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:320:39
Line |
 320 |                          $authResult = Connect-CSPTenant @authParams
     |                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Certificate authentication failed: Exception calling "Import" with "3" argument(s): "X509Certificate is immutable on this platform. Use the equivalent constructor instead."
Connect-CSPTenant: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:320:39
Line |
 320 |                          $authResult = Connect-CSPTenant @authParams
     |                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Certificate authentication failed: Exception calling "Import" with "3" argument(s): "X509Certificate is immutable on this platform. Use the equivalent constructor instead."

[2025-04-10 13:13:04] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 13:13:04] [ERROR] Authentication failed for tenant Chartered Group: Certificate authentication failed: Exception calling "Import" with "3" argument(s): "X509Certificate is immutable on this platform. Use the equivalent constructor instead."
[2025-04-10 13:13:04] [INFO] CSP Reporting process completed at 04/10/2025 13:13:04
**********************
PowerShell transcript end
End time: 20250410131304
**********************
**********************
PowerShell transcript start
Start time: 20250410131424
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 13:14:24] [INFO] Starting CSP Reporting process at 04/10/2025 13:14:24
[2025-04-10 13:14:24] [INFO] Processing tenant: Chartered Group
[2025-04-10 13:14:24] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-10 13:14:24] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant charteredgroup.onmicrosoft.com using Certificate authentication
PS>TerminatingError(Connect-MgGraph): "Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided."
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:320:39
Line |
 320 |                          $authResult = Connect-CSPTenant @authParams
     |                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Certificate authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided.
Connect-CSPTenant: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:320:39
Line |
 320 |                          $authResult = Connect-CSPTenant @authParams
     |                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Certificate authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient
     | number of parameters were provided.

[2025-04-10 13:14:24] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 13:14:24] [ERROR] Authentication failed for tenant Chartered Group: Certificate authentication failed: Parameter set cannot be resolved using the specified named parameters. One or more parameters issued cannot be used together or an insufficient number of parameters were provided.
[2025-04-10 13:14:24] [INFO] CSP Reporting process completed at 04/10/2025 13:14:24
**********************
PowerShell transcript end
End time: 20250410131424
**********************
**********************
PowerShell transcript start
Start time: 20250410131514
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 13:15:14] [INFO] Starting CSP Reporting process at 04/10/2025 13:15:14
[2025-04-10 13:15:14] [INFO] Processing tenant: Chartered Group
[2025-04-10 13:15:14] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-10 13:15:14] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant charteredgroup.onmicrosoft.com using Certificate authentication
Connect-MgGraph: ClientCertificateCredential authentication failed:
Connect-MgGraph: ClientCertificateCredential authentication failed: 

[2025-04-10 13:15:16] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 13:15:16] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 13:15:16] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 13:15:16] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 13:15:16] [ERROR] Error in Get-CSPMFAReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.
[2025-04-10 13:15:16] [INFO] Successfully generated MFA report for tenant Chartered Group
[2025-04-10 13:15:16] [INFO] Generating AuditLog report for tenant Chartered Group...
[2025-04-10 13:15:16] [INFO] Generating audit log report for tenant Chartered Group
[2025-04-10 13:15:16] [ERROR] Error in Get-CSPAuditLogReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.
[2025-04-10 13:15:16] [INFO] Successfully generated AuditLog report for tenant Chartered Group
[2025-04-10 13:15:16] [INFO] Generating DirectoryInfo report for tenant Chartered Group...
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:392:49
Line |
 392 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.
Get-CSPDirectoryReport: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:392:49
Line |
 392 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.

[2025-04-10 13:15:16] [ERROR] Failed to generate DirectoryInfo report for tenant Chartered Group
[2025-04-10 13:15:16] [INFO] Generating UsageReports report for tenant Chartered Group...
PS>TerminatingError(Get-CSPUsageReport): "Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String."
[2025-04-10 13:15:16] [ERROR] Error processing tenant Chartered Group: Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String.
True
[2025-04-10 13:15:16] [INFO] CSP Reporting process completed at 04/10/2025 13:15:16
**********************
PowerShell transcript end
End time: 20250410131516
**********************
**********************
PowerShell transcript start
Start time: 20250410132845
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 13:28:45] [INFO] Starting CSP Reporting process at 04/10/2025 13:28:45
[2025-04-10 13:28:45] [INFO] Processing tenant: Chartered Group
[2025-04-10 13:28:45] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-10 13:28:45] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant charteredgroup.onmicrosoft.com using Certificate authentication
PS>TerminatingError(New-Object): "Exception calling ".ctor" with "3" argument(s): "The specified network password is not correct.""
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:321:39
Line |
 321 |                          $authResult = Connect-CSPTenant @authParams
     |                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Certificate authentication failed: Exception calling ".ctor" with "3" argument(s): "The specified network password is not correct."
Connect-CSPTenant: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:321:39
Line |
 321 |                          $authResult = Connect-CSPTenant @authParams
     |                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Certificate authentication failed: Exception calling ".ctor" with "3" argument(s): "The specified network password is not correct."

[2025-04-10 13:28:45] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 13:28:45] [ERROR] Authentication failed for tenant Chartered Group: Certificate authentication failed: Exception calling ".ctor" with "3" argument(s): "The specified network password is not correct."
[2025-04-10 13:28:45] [INFO] CSP Reporting process completed at 04/10/2025 13:28:45
**********************
PowerShell transcript end
End time: 20250410132845
**********************
**********************
PowerShell transcript start
Start time: 20250410132954
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 13:29:54] [INFO] Starting CSP Reporting process at 04/10/2025 13:29:54
[2025-04-10 13:29:54] [INFO] Processing tenant: Chartered Group
[2025-04-10 13:29:54] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-10 13:29:54] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant charteredgroup.onmicrosoft.com using Certificate authentication
Connect-MgGraph: ClientCertificateCredential authentication failed:
Connect-MgGraph: ClientCertificateCredential authentication failed: 

[2025-04-10 13:29:55] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 13:29:55] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 13:29:55] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 13:29:55] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 13:29:55] [ERROR] Error in Get-CSPMFAReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.
[2025-04-10 13:29:55] [INFO] Successfully generated MFA report for tenant Chartered Group
[2025-04-10 13:29:55] [INFO] Generating AuditLog report for tenant Chartered Group...
[2025-04-10 13:29:55] [INFO] Generating audit log report for tenant Chartered Group
[2025-04-10 13:29:55] [ERROR] Error in Get-CSPAuditLogReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.
[2025-04-10 13:29:55] [INFO] Successfully generated AuditLog report for tenant Chartered Group
[2025-04-10 13:29:55] [INFO] Generating DirectoryInfo report for tenant Chartered Group...
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:393:49
Line |
 393 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.
Get-CSPDirectoryReport: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:393:49
Line |
 393 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.

[2025-04-10 13:29:55] [ERROR] Failed to generate DirectoryInfo report for tenant Chartered Group
[2025-04-10 13:29:55] [INFO] Generating UsageReports report for tenant Chartered Group...
PS>TerminatingError(Get-CSPUsageReport): "Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String."
[2025-04-10 13:29:55] [ERROR] Error processing tenant Chartered Group: Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String.
True
[2025-04-10 13:29:55] [INFO] CSP Reporting process completed at 04/10/2025 13:29:55
**********************
PowerShell transcript end
End time: 20250410132955
**********************
**********************
PowerShell transcript start
Start time: 20250410133112
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 13:31:12] [INFO] Starting CSP Reporting process at 04/10/2025 13:31:12
[2025-04-10 13:31:12] [INFO] Processing tenant: Chartered Group
[2025-04-10 13:31:12] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-10 13:31:12] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant charteredgroup.onmicrosoft.com using Certificate authentication
Connect-MgGraph: ClientCertificateCredential authentication failed:
Connect-MgGraph: ClientCertificateCredential authentication failed: 

[2025-04-10 13:31:13] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 13:31:13] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 13:31:13] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 13:31:13] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 13:31:13] [ERROR] Error in Get-CSPMFAReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.
[2025-04-10 13:31:13] [INFO] Successfully generated MFA report for tenant Chartered Group
[2025-04-10 13:31:13] [INFO] Generating AuditLog report for tenant Chartered Group...
[2025-04-10 13:31:13] [INFO] Generating audit log report for tenant Chartered Group
[2025-04-10 13:31:13] [ERROR] Error in Get-CSPAuditLogReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.
[2025-04-10 13:31:13] [INFO] Successfully generated AuditLog report for tenant Chartered Group
[2025-04-10 13:31:13] [INFO] Generating DirectoryInfo report for tenant Chartered Group...
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:399:49
Line |
 399 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.
Get-CSPDirectoryReport: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:399:49
Line |
 399 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Not connected to the correct tenant. Please connect to tenant charteredgroup.onmicrosoft.com first.

[2025-04-10 13:31:14] [ERROR] Failed to generate DirectoryInfo report for tenant Chartered Group
[2025-04-10 13:31:14] [INFO] Generating UsageReports report for tenant Chartered Group...
PS>TerminatingError(Get-CSPUsageReport): "Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String."
[2025-04-10 13:31:14] [ERROR] Error processing tenant Chartered Group: Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String.
True
[2025-04-10 13:31:14] [INFO] CSP Reporting process completed at 04/10/2025 13:31:14
**********************
PowerShell transcript end
End time: 20250410133114
**********************
**********************
PowerShell transcript start
Start time: 20250410133613
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 13:36:13] [INFO] Starting CSP Reporting process at 04/10/2025 13:36:13
[2025-04-10 13:36:13] [INFO] Processing tenant: Chartered Group
[2025-04-10 13:36:13] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-10 13:36:13] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
Connect-MgGraph: ClientCertificateCredential authentication failed:
Connect-MgGraph: ClientCertificateCredential authentication failed: 

[2025-04-10 13:36:14] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 13:36:14] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 13:36:14] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 13:36:14] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 13:36:14] [ERROR] Error in Get-CSPMFAReport: Not connected to the correct tenant. Please connect to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 first.
[2025-04-10 13:36:14] [INFO] Successfully generated MFA report for tenant Chartered Group
[2025-04-10 13:36:14] [INFO] Generating AuditLog report for tenant Chartered Group...
[2025-04-10 13:36:14] [INFO] Generating audit log report for tenant Chartered Group
[2025-04-10 13:36:14] [ERROR] Error in Get-CSPAuditLogReport: Not connected to the correct tenant. Please connect to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 first.
[2025-04-10 13:36:14] [INFO] Successfully generated AuditLog report for tenant Chartered Group
[2025-04-10 13:36:14] [INFO] Generating DirectoryInfo report for tenant Chartered Group...
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:399:49
Line |
 399 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Not connected to the correct tenant. Please connect to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 first.
Get-CSPDirectoryReport: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:399:49
Line |
 399 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Not connected to the correct tenant. Please connect to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 first.

[2025-04-10 13:36:14] [ERROR] Failed to generate DirectoryInfo report for tenant Chartered Group
[2025-04-10 13:36:14] [INFO] Generating UsageReports report for tenant Chartered Group...
PS>TerminatingError(Get-CSPUsageReport): "Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String."
[2025-04-10 13:36:14] [ERROR] Error processing tenant Chartered Group: Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String.
True
[2025-04-10 13:36:14] [INFO] CSP Reporting process completed at 04/10/2025 13:36:14
**********************
PowerShell transcript end
End time: 20250410133614
**********************
**********************
PowerShell transcript start
Start time: 20250410133756
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 13:37:56] [INFO] Starting CSP Reporting process at 04/10/2025 13:37:56
[2025-04-10 13:37:56] [INFO] Processing tenant: Chartered Group
[2025-04-10 13:37:56] [DEBUG] Using ClientId: 08616068-6348-4055-9c17-f04d332f23fc
[2025-04-10 13:37:56] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
Connect-MgGraph: ClientCertificateCredential authentication failed:
Connect-MgGraph: ClientCertificateCredential authentication failed: 

[2025-04-10 13:37:57] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 13:37:57] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 13:37:57] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 13:37:57] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 13:37:57] [ERROR] Error in Get-CSPMFAReport: Not connected to the correct tenant. Please connect to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 first.
[2025-04-10 13:37:57] [INFO] Successfully generated MFA report for tenant Chartered Group
[2025-04-10 13:37:57] [INFO] Generating AuditLog report for tenant Chartered Group...
[2025-04-10 13:37:57] [INFO] Generating audit log report for tenant Chartered Group
[2025-04-10 13:37:57] [ERROR] Error in Get-CSPAuditLogReport: Not connected to the correct tenant. Please connect to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 first.
[2025-04-10 13:37:57] [INFO] Successfully generated AuditLog report for tenant Chartered Group
[2025-04-10 13:37:57] [INFO] Generating DirectoryInfo report for tenant Chartered Group...
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:399:49
Line |
 399 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Not connected to the correct tenant. Please connect to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 first.
Get-CSPDirectoryReport: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:399:49
Line |
 399 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Not connected to the correct tenant. Please connect to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 first.

[2025-04-10 13:37:57] [ERROR] Failed to generate DirectoryInfo report for tenant Chartered Group
[2025-04-10 13:37:57] [INFO] Generating UsageReports report for tenant Chartered Group...
PS>TerminatingError(Get-CSPUsageReport): "Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String."
[2025-04-10 13:37:57] [ERROR] Error processing tenant Chartered Group: Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String.
True
[2025-04-10 13:37:57] [INFO] CSP Reporting process completed at 04/10/2025 13:37:57
**********************
PowerShell transcript end
End time: 20250410133757
**********************
**********************
PowerShell transcript start
Start time: 20250410133825
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 13:38:25] [INFO] Starting CSP Reporting process at 04/10/2025 13:38:25
[2025-04-10 13:38:25] [INFO] Processing tenant: Chartered Group
[2025-04-10 13:38:25] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 13:38:25] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 13:38:26] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 13:38:26] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 13:38:26] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 13:38:26] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 13:38:26] [INFO] Retrieving user count from tenant Chartered Group
Get-MgUser_List: Cannot overwrite variable True because it is read-only or constant.
Get-MgUser_List: Cannot overwrite variable True because it is read-only or constant.

[2025-04-10 13:38:29] [INFO] Found 0 users in tenant Chartered Group
[2025-04-10 13:38:29] [ERROR] Error in Get-CSPMFAReport: Attempted to divide by zero.
[2025-04-10 13:38:29] [INFO] Successfully generated MFA report for tenant Chartered Group
[2025-04-10 13:38:29] [INFO] Generating AuditLog report for tenant Chartered Group...
[2025-04-10 13:38:29] [INFO] Generating audit log report for tenant Chartered Group
[2025-04-10 13:38:29] [INFO] Retrieving audit logs from 2025-03-11T11:38:29Z to 2025-04-10T11:38:29Z
[2025-04-10 13:38:31] [INFO] Retrieved 100 audit logs
[2025-04-10 13:38:32] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:33] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:33] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:34] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:35] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:36] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:37] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:38] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:39] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:39] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:40] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:41] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:42] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:53] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:54] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:54] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:55] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:56] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:57] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:58] [INFO] Retrieved 1 audit logs
[2025-04-10 13:38:59] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:00] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:01] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:12] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:13] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:14] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:15] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:16] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:16] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:18] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:29] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:30] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:31] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:32] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:32] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:33] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:35] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:35] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:37] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:38] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:38] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:50] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:51] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:52] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:53] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:54] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:54] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:55] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:56] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:57] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:58] [INFO] Retrieved 1 audit logs
[2025-04-10 13:39:59] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:10] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:11] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:11] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:12] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:13] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:14] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:15] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:16] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:27] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:28] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:29] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:30] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:30] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:31] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:32] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:33] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:34] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:35] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:46] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:46] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:47] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:48] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:48] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:49] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:50] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:51] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:52] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:53] [INFO] Retrieved 1 audit logs
[2025-04-10 13:40:54] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:04] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:05] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:06] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:07] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:08] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:09] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:10] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:10] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:11] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:22] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:23] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:24] [INFO] Retrieved 1 audit logs
[2025-04-10 13:41:25] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:02] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:03] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:04] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:05] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:06] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:06] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:07] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:08] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:09] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:10] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:11] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:12] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:12] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:13] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:14] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:15] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:16] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:27] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:28] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:28] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:29] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:30] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:31] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:42] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:43] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:44] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:45] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:46] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:46] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:47] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:48] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:49] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:49] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:50] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:51] [INFO] Retrieved 1 audit logs
[2025-04-10 13:42:52] [INFO] Retrieved 1 audit logs
Get-MgAuditLogDirectoryAudit_List: Too many retries performed. More than 3 retries encountered while sending the request. (HTTP request failed with status code: TooManyRequests.{"error":{"code":"UnknownError","message":"Too Many Requests","innerError":{"date":"2025-04-10T11:42:52","request-id":"f4a04b0a-0b6c-49db-865f-22d1153e6284","client-request-id":"46043d33-8a12-4743-8368-a5725bf66a09"}}}) (HTTP request failed with status code: TooManyRequests.{"error":{"code":"UnknownError","message":"Too Many Requests","innerError":{"date":"2025-04-10T11:43:02","request-id":"7eecb3cf-504f-445c-87a8-6303d16489d4","client-request-id":"46ea60ae-e9c9-4db3-b1dd-ebaf7332cbff"}}}) (HTTP request failed with status code: TooManyRequests.{"error":{"code":"UnknownError","message":"Too Many Requests","innerError":{"date":"2025-04-10T11:43:12","request-id":"942b08cc-5a62-479c-813f-18610da4c120","client-request-id":"25a965a2-53c6-4d7f-81e9-f5b52e70f1f6"}}}) (HTTP request failed with status code: TooManyRequests.{"error":{"code":"UnknownError","message":"Too Many Requests","innerError":{"date":"2025-04-10T11:43:22","request-id":"8175b121-ab8a-4393-9794-765f1a6d2ffa","client-request-id":"0a9923c8-15c1-4f97-a06b-fecf64945db9"}}})
Get-MgAuditLogDirectoryAudit_List: Too many retries performed. More than 3 retries encountered while sending the request. (HTTP request failed with status code:
TooManyRequests.{"error":{"code":"UnknownError","message":"Too Many
Requests","innerError":{"date":"2025-04-10T11:42:52","request-id":"f4a04b0a-0b6c-49db-865f-22d1153e6284","client-request-id":"46043d33-8a12-4743-8368-a5725bf66a09"}}}) (HTTP request
failed with status code: TooManyRequests.{"error":{"code":"UnknownError","message":"Too Many
Requests","innerError":{"date":"2025-04-10T11:43:02","request-id":"7eecb3cf-504f-445c-87a8-6303d16489d4","client-request-id":"46ea60ae-e9c9-4db3-b1dd-ebaf7332cbff"}}}) (HTTP request
failed with status code: TooManyRequests.{"error":{"code":"UnknownError","message":"Too Many
Requests","innerError":{"date":"2025-04-10T11:43:12","request-id":"942b08cc-5a62-479c-813f-18610da4c120","client-request-id":"25a965a2-53c6-4d7f-81e9-f5b52e70f1f6"}}}) (HTTP request
failed with status code: TooManyRequests.{"error":{"code":"UnknownError","message":"Too Many
Requests","innerError":{"date":"2025-04-10T11:43:22","request-id":"8175b121-ab8a-4393-9794-765f1a6d2ffa","client-request-id":"0a9923c8-15c1-4f97-a06b-fecf64945db9"}}})

[2025-04-10 13:43:23] [INFO] No records returned, ending pagination
[2025-04-10 13:43:23] [INFO] Audit log report for tenant Chartered Group completed. Retrieved 230 audit log entries.
[2025-04-10 13:43:23] [INFO] Successfully generated AuditLog report for tenant Chartered Group
[2025-04-10 13:43:23] [INFO] Generating DirectoryInfo report for tenant Chartered Group...
Get-MgDomain_List: Insufficient privileges to complete the operation.  Status: 403 (Forbidden) ErrorCode: Authorization_RequestDenied Date: 2025-04-10T11:43:25  Headers: Cache-Control                 : no-cache Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : 4585034f-13bf-419c-8c67-cfa88cb03871 client-request-id             : 3f3bfb00-dedb-448a-ac13-d048bf80231d x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000291"}} x-ms-resource-unit            : 1 Date                          : Thu, 10 Apr 2025 11:43:25 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgDomain_List: Insufficient privileges to complete the operation.  Status: 403 (Forbidden) ErrorCode: Authorization_RequestDenied Date: 2025-04-10T11:43:25  Headers: Cache-Control                 :
no-cache Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : 4585034f-13bf-419c-8c67-cfa88cb03871
client-request-id             : 3f3bfb00-dedb-448a-ac13-d048bf80231d x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000291"}} x-ms-resource-unit            : 1 Date                          : Thu, 10 Apr 2025 11:43:25 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
PS>TerminatingError(Get-MgUser): "Missing an argument for parameter 'CountVariable'. Specify a parameter of type 'System.String' and try again."
Write-Error: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:399:49
Line |
 399 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Missing an argument for parameter 'CountVariable'. Specify a parameter of type 'System.String' and try again.
Get-CSPDirectoryReport: D:\Clients\Netsurit\CSP Reporting\Start-CSPReporting.ps1:399:49
Line |
 399 |  …                  $reportResult = Get-CSPDirectoryReport @reportParams
     |                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Error in Get-CSPDirectoryReport: Missing an argument for parameter 'CountVariable'. Specify a parameter of type 'System.String' and try again.

[2025-04-10 13:43:26] [ERROR] Failed to generate DirectoryInfo report for tenant Chartered Group
[2025-04-10 13:43:26] [INFO] Generating UsageReports report for tenant Chartered Group...
PS>TerminatingError(Get-CSPUsageReport): "Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String."
[2025-04-10 13:43:26] [ERROR] Error processing tenant Chartered Group: Cannot process argument transformation on parameter 'Period'. Cannot convert value to type System.String.

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Group.Read.All, User.Read.All, AuditLog.Read.All}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 13:43:26] [INFO] CSP Reporting process completed at 04/10/2025 13:43:26
**********************
PowerShell transcript end
End time: 20250410134326
**********************
**********************
PowerShell transcript start
Start time: 20250410153115
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 15:31:15] [INFO] Starting CSP Reporting process at 04/10/2025 15:31:15
[2025-04-10 15:31:15] [INFO] Processing tenant: Chartered Group
[2025-04-10 15:31:15] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 15:31:15] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 15:31:16] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 15:31:16] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 15:31:16] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 15:31:16] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 15:31:16] [INFO] Retrieving user count from tenant Chartered Group
PS>TerminatingError(Get-MgUser): "Missing an argument for parameter 'CountVariable'. Specify a parameter of type 'System.String' and try again."
>> TerminatingError(Get-MgUser): "Missing an argument for parameter 'CountVariable'. Specify a parameter of type 'System.String' and try again."
[2025-04-10 15:31:16] [ERROR] Non-retryable error in Get user count. Error: Missing an argument for parameter 'CountVariable'. Specify a parameter of type 'System.String' and try again.
Write-Error: Error in Invoke-CSPWithRetry: Missing an argument for parameter 'CountVariable'. Specify a parameter of type 'System.String' and try again.
Invoke-CSPWithRetry: Error in Invoke-CSPWithRetry: Missing an argument for parameter 'CountVariable'. Specify a parameter of type 'System.String' and try again.

PS>TerminatingError(Get-MgUser): "Missing an argument for parameter 'CountVariable'. Specify a parameter of type 'System.String' and try again."
[2025-04-10 15:31:16] [ERROR] Error in Get-CSPMFAReport: Missing an argument for parameter 'CountVariable'. Specify a parameter of type 'System.String' and try again.
[2025-04-10 15:31:16] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, Group.Read.All, Directory.Read.All, User.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 15:31:16] [INFO] CSP Reporting process completed at 04/10/2025 15:31:16
**********************
PowerShell transcript end
End time: 20250410153116
**********************
**********************
PowerShell transcript start
Start time: 20250410153221
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 15:32:21] [INFO] Starting CSP Reporting process at 04/10/2025 15:32:21
[2025-04-10 15:32:21] [INFO] Processing tenant: Chartered Group
[2025-04-10 15:32:21] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 15:32:21] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 15:32:21] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 15:32:21] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 15:32:21] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 15:32:21] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 15:32:21] [INFO] Retrieving user count from tenant Chartered Group
Get-MgUser_List: Cannot overwrite variable true because it is read-only or constant.
Get-MgUser_List: Cannot overwrite variable true because it is read-only or constant.

[2025-04-10 15:32:22] [INFO] Found 0 users in tenant Chartered Group
[2025-04-10 15:32:22] [WARNING] No users found in tenant Chartered Group, skipping MFA report generation.
[2025-04-10 15:32:22] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, Group.Read.All, Directory.Read.All, User.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 15:32:22] [INFO] CSP Reporting process completed at 04/10/2025 15:32:22
**********************
PowerShell transcript end
End time: 20250410153222
**********************
**********************
PowerShell transcript start
Start time: 20250410153354
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 15:33:55] [INFO] Starting CSP Reporting process at 04/10/2025 15:33:55
[2025-04-10 15:33:55] [INFO] Processing tenant: Chartered Group
[2025-04-10 15:33:55] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 15:33:55] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 15:33:55] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 15:33:55] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 15:33:55] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 15:33:55] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 15:33:55] [INFO] Retrieving user count from tenant Chartered Group
Get-MgUser_List: Cannot overwrite variable true because it is read-only or constant.
Get-MgUser_List: Cannot overwrite variable true because it is read-only or constant.

[2025-04-10 15:33:56] [INFO] Found 0 users in tenant Chartered Group
[2025-04-10 15:33:56] [WARNING] No users found in tenant Chartered Group, skipping MFA report generation.
[2025-04-10 15:33:56] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, Group.Read.All, Directory.Read.All, User.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 15:33:56] [INFO] CSP Reporting process completed at 04/10/2025 15:33:56
**********************
PowerShell transcript end
End time: 20250410153356
**********************
**********************
PowerShell transcript start
Start time: 20250410153956
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 15:39:56] [INFO] Starting CSP Reporting process at 04/10/2025 15:39:56
[2025-04-10 15:39:56] [INFO] Processing tenant: Chartered Group
[2025-04-10 15:39:56] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 15:39:56] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 15:39:57] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 15:39:57] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 15:39:57] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 15:39:57] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 15:39:57] [INFO] Retrieving user count from tenant Chartered Group
Get-MgUser_List: Cannot overwrite variable true because it is read-only or constant.
Get-MgUser_List: Cannot overwrite variable true because it is read-only or constant.

[2025-04-10 15:39:58] [INFO] Found 0 users in tenant Chartered Group
[2025-04-10 15:39:58] [WARNING] No users found in tenant Chartered Group, skipping MFA report generation.
[2025-04-10 15:39:58] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, Group.Read.All, Directory.Read.All, User.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 15:39:58] [INFO] CSP Reporting process completed at 04/10/2025 15:39:58
**********************
PowerShell transcript end
End time: 20250410153958
**********************
**********************
PowerShell transcript start
Start time: 20250410154144
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 15:41:44] [INFO] Starting CSP Reporting process at 04/10/2025 15:41:44
[2025-04-10 15:41:44] [INFO] Processing tenant: Chartered Group
[2025-04-10 15:41:44] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 15:41:44] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 15:41:45] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 15:41:45] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 15:41:45] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 15:41:45] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 15:41:45] [INFO] Retrieving user count from tenant Chartered Group
PS>TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: e82b4fdc-038d-4193-8998-4c700dd6d090
client-request-id: d5928174-7e30-489e-9624-5b0d0c9a690b
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001168"}}
Date: Thu, 10 Apr 2025 13:41:44 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:41:45","request-id":"e82b4fdc-038d-4193-8998-4c700dd6d090","client-request-id":"d5928174-7e30-489e-9624-5b0d0c9a690b"}}}"
>> TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: e82b4fdc-038d-4193-8998-4c700dd6d090
client-request-id: d5928174-7e30-489e-9624-5b0d0c9a690b
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001168"}}
Date: Thu, 10 Apr 2025 13:41:44 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:41:45","request-id":"e82b4fdc-038d-4193-8998-4c700dd6d090","client-request-id":"d5928174-7e30-489e-9624-5b0d0c9a690b"}}}"
[2025-04-10 15:41:45] [ERROR] Non-retryable error in Get user count. Error: Response status code does not indicate success: BadRequest (Bad Request).
Write-Error: Error in Invoke-CSPWithRetry: GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true HTTP/2.0 400 Bad Request Vary: Accept-Encoding Strict-Transport-Security: max-age=31536000 request-id: e82b4fdc-038d-4193-8998-4c700dd6d090 client-request-id: d5928174-7e30-489e-9624-5b0d0c9a690b x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001168"}} Date: Thu, 10 Apr 2025 13:41:44 GMT Content-Type: application/json  {"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:41:45","request-id":"e82b4fdc-038d-4193-8998-4c700dd6d090","client-request-id":"d5928174-7e30-489e-9624-5b0d0c9a690b"}}}
Invoke-CSPWithRetry: Error in Invoke-CSPWithRetry: GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true HTTP/2.0 400 Bad Request Vary: Accept-Encoding Strict-Transport-Security:
max-age=31536000 request-id: e82b4fdc-038d-4193-8998-4c700dd6d090 client-request-id: d5928174-7e30-489e-9624-5b0d0c9a690b x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001168"}} Date: Thu, 10 Apr 2025 13:41:44 GMT Content-Type: application/json 
{"error":{"code":"BadRequest","message":"Invalid
version.","innerError":{"date":"2025-04-10T13:41:45","request-id":"e82b4fdc-038d-4193-8998-4c700dd6d090","client-request-id":"d5928174-7e30-489e-9624-5b0d0c9a690b"}}}

PS>TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: e82b4fdc-038d-4193-8998-4c700dd6d090
client-request-id: d5928174-7e30-489e-9624-5b0d0c9a690b
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001168"}}
Date: Thu, 10 Apr 2025 13:41:44 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:41:45","request-id":"e82b4fdc-038d-4193-8998-4c700dd6d090","client-request-id":"d5928174-7e30-489e-9624-5b0d0c9a690b"}}}"
[2025-04-10 15:41:45] [ERROR] Error in Get-CSPMFAReport: Response status code does not indicate success: BadRequest (Bad Request).
[2025-04-10 15:41:45] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, Group.Read.All, Directory.Read.All, User.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 15:41:45] [INFO] CSP Reporting process completed at 04/10/2025 15:41:45
**********************
PowerShell transcript end
End time: 20250410154145
**********************
**********************
PowerShell transcript start
Start time: 20250410154330
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 15:43:30] [INFO] Starting CSP Reporting process at 04/10/2025 15:43:30
[2025-04-10 15:43:30] [INFO] Processing tenant: Chartered Group
[2025-04-10 15:43:30] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 15:43:30] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 15:43:31] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 15:43:31] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 15:43:31] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 15:43:31] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 15:43:31] [INFO] Retrieving user count from tenant Chartered Group
[2025-04-10 15:43:31] [DEBUG] User count request URL: $count=true&$top=1&$filter=accountEnabled+eq+true
PS>TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: abd5b816-0c1d-4045-a101-dcfc7e4efce0
client-request-id: 10abf143-e155-452c-a828-05153461781d
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF0000125F"}}
Date: Thu, 10 Apr 2025 13:43:30 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:43:30","request-id":"abd5b816-0c1d-4045-a101-dcfc7e4efce0","client-request-id":"10abf143-e155-452c-a828-05153461781d"}}}"
>> TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: abd5b816-0c1d-4045-a101-dcfc7e4efce0
client-request-id: 10abf143-e155-452c-a828-05153461781d
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF0000125F"}}
Date: Thu, 10 Apr 2025 13:43:30 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:43:30","request-id":"abd5b816-0c1d-4045-a101-dcfc7e4efce0","client-request-id":"10abf143-e155-452c-a828-05153461781d"}}}"
[2025-04-10 15:43:31] [ERROR] Non-retryable error in Get user count. Error: Response status code does not indicate success: BadRequest (Bad Request).
Write-Error: Error in Invoke-CSPWithRetry: GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true HTTP/2.0 400 Bad Request Vary: Accept-Encoding Strict-Transport-Security: max-age=31536000 request-id: abd5b816-0c1d-4045-a101-dcfc7e4efce0 client-request-id: 10abf143-e155-452c-a828-05153461781d x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF0000125F"}} Date: Thu, 10 Apr 2025 13:43:30 GMT Content-Type: application/json  {"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:43:30","request-id":"abd5b816-0c1d-4045-a101-dcfc7e4efce0","client-request-id":"10abf143-e155-452c-a828-05153461781d"}}}
Invoke-CSPWithRetry: Error in Invoke-CSPWithRetry: GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true HTTP/2.0 400 Bad Request Vary: Accept-Encoding Strict-Transport-Security:
max-age=31536000 request-id: abd5b816-0c1d-4045-a101-dcfc7e4efce0 client-request-id: 10abf143-e155-452c-a828-05153461781d x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF0000125F"}} Date: Thu, 10 Apr 2025 13:43:30 GMT Content-Type: application/json 
{"error":{"code":"BadRequest","message":"Invalid
version.","innerError":{"date":"2025-04-10T13:43:30","request-id":"abd5b816-0c1d-4045-a101-dcfc7e4efce0","client-request-id":"10abf143-e155-452c-a828-05153461781d"}}}

PS>TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: abd5b816-0c1d-4045-a101-dcfc7e4efce0
client-request-id: 10abf143-e155-452c-a828-05153461781d
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF0000125F"}}
Date: Thu, 10 Apr 2025 13:43:30 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:43:30","request-id":"abd5b816-0c1d-4045-a101-dcfc7e4efce0","client-request-id":"10abf143-e155-452c-a828-05153461781d"}}}"
[2025-04-10 15:43:31] [ERROR] Error in Get-CSPMFAReport: Response status code does not indicate success: BadRequest (Bad Request).
[2025-04-10 15:43:31] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, Group.Read.All, Directory.Read.All, User.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 15:43:31] [INFO] CSP Reporting process completed at 04/10/2025 15:43:31
**********************
PowerShell transcript end
End time: 20250410154331
**********************
**********************
PowerShell transcript start
Start time: 20250410154423
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 15:44:23] [INFO] Starting CSP Reporting process at 04/10/2025 15:44:23
[2025-04-10 15:44:23] [INFO] Processing tenant: Chartered Group
[2025-04-10 15:44:23] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 15:44:23] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 15:44:24] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 15:44:24] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 15:44:24] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 15:44:24] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 15:44:24] [INFO] Retrieving user count from tenant Chartered Group
[2025-04-10 15:44:24] [DEBUG] User count request URL: $count=true&$top=1&$filter=accountEnabled+eq+true
PS>TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: bd4d686a-88ff-4504-ae35-b3e5fd9d012a
client-request-id: e2378c0a-6527-4a7e-8611-0e6d1c989011
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF0000125F"}}
Date: Thu, 10 Apr 2025 13:44:23 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:44:23","request-id":"bd4d686a-88ff-4504-ae35-b3e5fd9d012a","client-request-id":"e2378c0a-6527-4a7e-8611-0e6d1c989011"}}}"
>> TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: bd4d686a-88ff-4504-ae35-b3e5fd9d012a
client-request-id: e2378c0a-6527-4a7e-8611-0e6d1c989011
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF0000125F"}}
Date: Thu, 10 Apr 2025 13:44:23 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:44:23","request-id":"bd4d686a-88ff-4504-ae35-b3e5fd9d012a","client-request-id":"e2378c0a-6527-4a7e-8611-0e6d1c989011"}}}"
[2025-04-10 15:44:24] [ERROR] Non-retryable error in Get user count. Error: Response status code does not indicate success: BadRequest (Bad Request).
Write-Error: Error in Invoke-CSPWithRetry: GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true HTTP/2.0 400 Bad Request Vary: Accept-Encoding Strict-Transport-Security: max-age=31536000 request-id: bd4d686a-88ff-4504-ae35-b3e5fd9d012a client-request-id: e2378c0a-6527-4a7e-8611-0e6d1c989011 x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF0000125F"}} Date: Thu, 10 Apr 2025 13:44:23 GMT Content-Type: application/json  {"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:44:23","request-id":"bd4d686a-88ff-4504-ae35-b3e5fd9d012a","client-request-id":"e2378c0a-6527-4a7e-8611-0e6d1c989011"}}}
Invoke-CSPWithRetry: Error in Invoke-CSPWithRetry: GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true HTTP/2.0 400 Bad Request Vary: Accept-Encoding Strict-Transport-Security:
max-age=31536000 request-id: bd4d686a-88ff-4504-ae35-b3e5fd9d012a client-request-id: e2378c0a-6527-4a7e-8611-0e6d1c989011 x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF0000125F"}} Date: Thu, 10 Apr 2025 13:44:23 GMT Content-Type: application/json 
{"error":{"code":"BadRequest","message":"Invalid
version.","innerError":{"date":"2025-04-10T13:44:23","request-id":"bd4d686a-88ff-4504-ae35-b3e5fd9d012a","client-request-id":"e2378c0a-6527-4a7e-8611-0e6d1c989011"}}}

PS>TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: bd4d686a-88ff-4504-ae35-b3e5fd9d012a
client-request-id: e2378c0a-6527-4a7e-8611-0e6d1c989011
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF0000125F"}}
Date: Thu, 10 Apr 2025 13:44:23 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:44:23","request-id":"bd4d686a-88ff-4504-ae35-b3e5fd9d012a","client-request-id":"e2378c0a-6527-4a7e-8611-0e6d1c989011"}}}"
[2025-04-10 15:44:24] [ERROR] Error in Get-CSPMFAReport: Response status code does not indicate success: BadRequest (Bad Request).
[2025-04-10 15:44:24] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, Group.Read.All, Directory.Read.All, User.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 15:44:24] [INFO] CSP Reporting process completed at 04/10/2025 15:44:24
**********************
PowerShell transcript end
End time: 20250410154424
**********************
**********************
PowerShell transcript start
Start time: 20250410154931
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 15:49:31] [INFO] Starting CSP Reporting process at 04/10/2025 15:49:31
[2025-04-10 15:49:31] [INFO] Processing tenant: Chartered Group
[2025-04-10 15:49:31] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 15:49:31] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 15:49:32] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 15:49:32] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 15:49:32] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 15:49:32] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 15:49:32] [INFO] Retrieving user count from tenant Chartered Group
[2025-04-10 15:49:32] [DEBUG] DEBUG: baseUrl = https://graph.microsoft.com/v1.0/users
[2025-04-10 15:49:32] [DEBUG] DEBUG: query = $count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 15:49:32] [DEBUG] DEBUG: userCountUrl = $count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 15:49:32] [DEBUG] User count request URL: $count=true&$top=1&$filter=accountEnabled+eq+true
PS>TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: f7fd8ab7-999b-4d61-a33c-9856a251f8ab
client-request-id: 38bdb8c3-5819-4fce-badf-579a6eea8435
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF000002B7"}}
Date: Thu, 10 Apr 2025 13:49:30 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:49:31","request-id":"f7fd8ab7-999b-4d61-a33c-9856a251f8ab","client-request-id":"38bdb8c3-5819-4fce-badf-579a6eea8435"}}}"
>> TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: f7fd8ab7-999b-4d61-a33c-9856a251f8ab
client-request-id: 38bdb8c3-5819-4fce-badf-579a6eea8435
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF000002B7"}}
Date: Thu, 10 Apr 2025 13:49:30 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:49:31","request-id":"f7fd8ab7-999b-4d61-a33c-9856a251f8ab","client-request-id":"38bdb8c3-5819-4fce-badf-579a6eea8435"}}}"
[2025-04-10 15:49:32] [ERROR] Non-retryable error in Get user count. Error: Response status code does not indicate success: BadRequest (Bad Request).
Write-Error: Error in Invoke-CSPWithRetry: GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true HTTP/2.0 400 Bad Request Vary: Accept-Encoding Strict-Transport-Security: max-age=31536000 request-id: f7fd8ab7-999b-4d61-a33c-9856a251f8ab client-request-id: 38bdb8c3-5819-4fce-badf-579a6eea8435 x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF000002B7"}} Date: Thu, 10 Apr 2025 13:49:30 GMT Content-Type: application/json  {"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:49:31","request-id":"f7fd8ab7-999b-4d61-a33c-9856a251f8ab","client-request-id":"38bdb8c3-5819-4fce-badf-579a6eea8435"}}}
Invoke-CSPWithRetry: Error in Invoke-CSPWithRetry: GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true HTTP/2.0 400 Bad Request Vary: Accept-Encoding Strict-Transport-Security:
max-age=31536000 request-id: f7fd8ab7-999b-4d61-a33c-9856a251f8ab client-request-id: 38bdb8c3-5819-4fce-badf-579a6eea8435 x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF000002B7"}} Date: Thu, 10 Apr 2025 13:49:30 GMT Content-Type: application/json 
{"error":{"code":"BadRequest","message":"Invalid
version.","innerError":{"date":"2025-04-10T13:49:31","request-id":"f7fd8ab7-999b-4d61-a33c-9856a251f8ab","client-request-id":"38bdb8c3-5819-4fce-badf-579a6eea8435"}}}

PS>TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: f7fd8ab7-999b-4d61-a33c-9856a251f8ab
client-request-id: 38bdb8c3-5819-4fce-badf-579a6eea8435
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF000002B7"}}
Date: Thu, 10 Apr 2025 13:49:30 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:49:31","request-id":"f7fd8ab7-999b-4d61-a33c-9856a251f8ab","client-request-id":"38bdb8c3-5819-4fce-badf-579a6eea8435"}}}"
[2025-04-10 15:49:32] [ERROR] Error in Get-CSPMFAReport: Response status code does not indicate success: BadRequest (Bad Request).
[2025-04-10 15:49:32] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, Group.Read.All, Directory.Read.All, User.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 15:49:32] [INFO] CSP Reporting process completed at 04/10/2025 15:49:32
**********************
PowerShell transcript end
End time: 20250410154932
**********************
**********************
PowerShell transcript start
Start time: 20250410155052
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 15:50:52] [INFO] Starting CSP Reporting process at 04/10/2025 15:50:52
[2025-04-10 15:50:52] [INFO] Processing tenant: Chartered Group
[2025-04-10 15:50:52] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 15:50:52] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 15:50:52] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 15:50:52] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 15:50:52] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 15:50:52] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 15:50:52] [INFO] Retrieving user count from tenant Chartered Group
[2025-04-10 15:50:52] [DEBUG] DEBUG: baseUrl = https://graph.microsoft.com/v1.0/users
[2025-04-10 15:50:52] [DEBUG] DEBUG: query = $count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 15:50:52] [DEBUG] DEBUG: userCountUrl = $count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 15:50:52] [DEBUG] User count request URL: $count=true&$top=1&$filter=accountEnabled+eq+true
PS>TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: dc43c87c-f32e-4d01-80c4-9cf3b8d60343
client-request-id: 26effdf6-4843-43f7-bcc6-78e0c2f242b2
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF000002B7"}}
Date: Thu, 10 Apr 2025 13:50:51 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:50:52","request-id":"dc43c87c-f32e-4d01-80c4-9cf3b8d60343","client-request-id":"26effdf6-4843-43f7-bcc6-78e0c2f242b2"}}}"
>> TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: dc43c87c-f32e-4d01-80c4-9cf3b8d60343
client-request-id: 26effdf6-4843-43f7-bcc6-78e0c2f242b2
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF000002B7"}}
Date: Thu, 10 Apr 2025 13:50:51 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:50:52","request-id":"dc43c87c-f32e-4d01-80c4-9cf3b8d60343","client-request-id":"26effdf6-4843-43f7-bcc6-78e0c2f242b2"}}}"
[2025-04-10 15:50:52] [ERROR] Non-retryable error in Get user count. Error: Response status code does not indicate success: BadRequest (Bad Request).
Write-Error: Error in Invoke-CSPWithRetry: GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true HTTP/2.0 400 Bad Request Vary: Accept-Encoding Strict-Transport-Security: max-age=31536000 request-id: dc43c87c-f32e-4d01-80c4-9cf3b8d60343 client-request-id: 26effdf6-4843-43f7-bcc6-78e0c2f242b2 x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF000002B7"}} Date: Thu, 10 Apr 2025 13:50:51 GMT Content-Type: application/json  {"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:50:52","request-id":"dc43c87c-f32e-4d01-80c4-9cf3b8d60343","client-request-id":"26effdf6-4843-43f7-bcc6-78e0c2f242b2"}}}
Invoke-CSPWithRetry: Error in Invoke-CSPWithRetry: GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true HTTP/2.0 400 Bad Request Vary: Accept-Encoding Strict-Transport-Security:
max-age=31536000 request-id: dc43c87c-f32e-4d01-80c4-9cf3b8d60343 client-request-id: 26effdf6-4843-43f7-bcc6-78e0c2f242b2 x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF000002B7"}} Date: Thu, 10 Apr 2025 13:50:51 GMT Content-Type: application/json 
{"error":{"code":"BadRequest","message":"Invalid
version.","innerError":{"date":"2025-04-10T13:50:52","request-id":"dc43c87c-f32e-4d01-80c4-9cf3b8d60343","client-request-id":"26effdf6-4843-43f7-bcc6-78e0c2f242b2"}}}

PS>TerminatingError(Invoke-MgGraphRequest): "GET https://graph.microsoft.com/$count=true&$top=1&$filter=accountEnabled+eq+true
HTTP/2.0 400 Bad Request
Vary: Accept-Encoding
Strict-Transport-Security: max-age=31536000
request-id: dc43c87c-f32e-4d01-80c4-9cf3b8d60343
client-request-id: 26effdf6-4843-43f7-bcc6-78e0c2f242b2
x-ms-ags-diagnostic: {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF000002B7"}}
Date: Thu, 10 Apr 2025 13:50:51 GMT
Content-Type: application/json

{"error":{"code":"BadRequest","message":"Invalid version.","innerError":{"date":"2025-04-10T13:50:52","request-id":"dc43c87c-f32e-4d01-80c4-9cf3b8d60343","client-request-id":"26effdf6-4843-43f7-bcc6-78e0c2f242b2"}}}"
[2025-04-10 15:50:53] [ERROR] Error in Get-CSPMFAReport: Response status code does not indicate success: BadRequest (Bad Request).
[2025-04-10 15:50:53] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, Group.Read.All, Directory.Read.All, User.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 15:50:53] [INFO] CSP Reporting process completed at 04/10/2025 15:50:53
**********************
PowerShell transcript end
End time: 20250410155053
**********************
**********************
PowerShell transcript start
Start time: 20250410155150
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 15:51:50] [INFO] Starting CSP Reporting process at 04/10/2025 15:51:50
[2025-04-10 15:51:50] [INFO] Processing tenant: Chartered Group
[2025-04-10 15:51:50] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 15:51:50] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 15:51:51] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 15:51:51] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 15:51:51] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 15:51:51] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 15:51:51] [INFO] Retrieving user count from tenant Chartered Group
[2025-04-10 15:51:51] [DEBUG] DEBUG: baseUrl = https://graph.microsoft.com/v1.0/users
[2025-04-10 15:51:51] [DEBUG] DEBUG: query = $count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 15:51:51] [DEBUG] DEBUG: userCountUrl = https://graph.microsoft.com/v1.0/users?$count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 15:51:51] [DEBUG] User count request URL: https://graph.microsoft.com/v1.0/users?$count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 15:51:51] [INFO] Found 355 users in tenant Chartered Group
PS>TerminatingError(Get-MgUser): "A parameter cannot be found that matches parameter name 'Skip'."
>> TerminatingError(Get-MgUser): "A parameter cannot be found that matches parameter name 'Skip'."
[2025-04-10 15:51:51] [ERROR] Non-retryable error in Get user batch. Error: A parameter cannot be found that matches parameter name 'Skip'.
Write-Error: Error in Invoke-CSPWithRetry: A parameter cannot be found that matches parameter name 'Skip'.
Invoke-CSPWithRetry: Error in Invoke-CSPWithRetry: A parameter cannot be found that matches parameter name 'Skip'.

PS>TerminatingError(Get-MgUser): "A parameter cannot be found that matches parameter name 'Skip'."
[2025-04-10 15:51:51] [ERROR] Error in Get-CSPMFAReport: A parameter cannot be found that matches parameter name 'Skip'.
[2025-04-10 15:51:51] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, Group.Read.All, Directory.Read.All, User.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 15:51:51] [INFO] CSP Reporting process completed at 04/10/2025 15:51:51
**********************
PowerShell transcript end
End time: 20250410155151
**********************
**********************
PowerShell transcript start
Start time: 20250410163553
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 16:35:53] [INFO] Starting CSP Reporting process at 04/10/2025 16:35:53
[2025-04-10 16:35:53] [INFO] Processing tenant: Chartered Group
[2025-04-10 16:35:53] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 16:35:53] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 16:35:54] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 16:35:54] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 16:35:54] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 16:35:54] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 16:35:54] [INFO] Retrieving user count from tenant Chartered Group
[2025-04-10 16:35:54] [DEBUG] DEBUG: baseUrl = https://graph.microsoft.com/v1.0/users
[2025-04-10 16:35:54] [DEBUG] DEBUG: query = $count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 16:35:54] [DEBUG] DEBUG: userCountUrl = https://graph.microsoft.com/v1.0/users?$count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 16:35:54] [DEBUG] User count request URL: https://graph.microsoft.com/v1.0/users?$count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 16:35:54] [INFO] Found 355 users in tenant Chartered Group
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:35:57  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : 59f57b6e-3f59-463b-9746-9f8df52681c1 client-request-id             : 846dd174-f9ba-45bc-b9ca-43c45ff5a8e2 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:56 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:35:57  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : 59f57b6e-3f59-463b-9746-9f8df52681c1 client-request-id             :
846dd174-f9ba-45bc-b9ca-43c45ff5a8e2 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:56 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:35:58  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : 28955d77-dae5-4e88-a479-6973e8099efc client-request-id             : d6b2aabc-5485-4333-bed8-3163262d3638 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:57 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:35:58  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : 28955d77-dae5-4e88-a479-6973e8099efc client-request-id             :
d6b2aabc-5485-4333-bed8-3163262d3638 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:57 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:35:58  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : bcd00a51-e849-484e-ad01-f300b6df735f client-request-id             : e4839da6-cf6d-4f3f-bb39-866704aa6d76 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:58 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:35:58  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : bcd00a51-e849-484e-ad01-f300b6df735f client-request-id             :
e4839da6-cf6d-4f3f-bb39-866704aa6d76 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:58 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:35:59  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : d59dc278-dbc9-4ff0-aecc-ed9009def490 client-request-id             : 52a800cd-58ce-45b6-aba9-fc96411163e5 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:58 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:35:59  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : d59dc278-dbc9-4ff0-aecc-ed9009def490 client-request-id             :
52a800cd-58ce-45b6-aba9-fc96411163e5 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:58 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:36:00  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : fd4aeadf-b62a-40bf-98ec-7d341eac273f client-request-id             : 6aed6763-4f63-4c8f-8bfa-54639922f679 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:59 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:36:00  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : fd4aeadf-b62a-40bf-98ec-7d341eac273f client-request-id             :
6aed6763-4f63-4c8f-8bfa-54639922f679 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:59 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:36:00  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : a422659a-1b27-42f2-922f-0016418ab3c0 client-request-id             : 340b250c-e38c-41ef-809e-a18c28cfad6a x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:59 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:36:00  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : a422659a-1b27-42f2-922f-0016418ab3c0 client-request-id             :
340b250c-e38c-41ef-809e-a18c28cfad6a x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:35:59 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:36:01  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : b4a056d9-72e5-46e8-962c-bf96b1aea332 client-request-id             : 894d4a4f-9673-4c8c-883e-6a506f8ba5f1 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:36:00 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T14:36:01  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : b4a056d9-72e5-46e8-962c-bf96b1aea332 client-request-id             :
894d4a4f-9673-4c8c-883e-6a506f8ba5f1 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"000","RoleInstance":"JN1PEPF00001169"}} Date                          : Thu, 10 Apr 2025 14:36:00 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
PS>TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
**********************
PowerShell transcript end
End time: 20250410163602
**********************
**********************
PowerShell transcript start
Start time: 20250410173045
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 17:30:45] [INFO] Starting CSP Reporting process at 04/10/2025 17:30:45
[2025-04-10 17:30:45] [INFO] Processing tenant: Chartered Group
[2025-04-10 17:30:45] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 17:30:45] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 17:30:45] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 17:30:45] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 17:30:45] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 17:30:45] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 17:30:45] [INFO] Retrieving user count from tenant Chartered Group
[2025-04-10 17:30:45] [DEBUG] DEBUG: baseUrl = https://graph.microsoft.com/v1.0/users
[2025-04-10 17:30:45] [DEBUG] DEBUG: query = $count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 17:30:45] [DEBUG] DEBUG: userCountUrl = https://graph.microsoft.com/v1.0/users?$count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 17:30:45] [DEBUG] User count request URL: https://graph.microsoft.com/v1.0/users?$count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 17:30:46] [INFO] Found 355 users in tenant Chartered Group
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:46  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : b2f162b8-b675-4ea5-8081-94fb0ab92a12 client-request-id             : 5596f945-3c02-48ce-8d79-d21aefc5d114 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:46 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:46  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : b2f162b8-b675-4ea5-8081-94fb0ab92a12 client-request-id             :
5596f945-3c02-48ce-8d79-d21aefc5d114 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:46 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:47  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : e7f3a4b1-d84a-4ad8-b365-e415c5188d55 client-request-id             : 4ed0d224-0857-4ca3-85a8-95ec910a82c0 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:47 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:47  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : e7f3a4b1-d84a-4ad8-b365-e415c5188d55 client-request-id             :
4ed0d224-0857-4ca3-85a8-95ec910a82c0 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:47 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:48  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : af977c1b-399d-469c-a301-bdacc6168a66 client-request-id             : a08a5f09-f170-4625-b38b-1b1fbb06589c x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:48 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:48  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : af977c1b-399d-469c-a301-bdacc6168a66 client-request-id             :
a08a5f09-f170-4625-b38b-1b1fbb06589c x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:48 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:50  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : 4ce19766-5ace-4d1d-9643-cd176502b592 client-request-id             : 0a355195-9d94-4db9-affe-53796d032726 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:49 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:50  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : 4ce19766-5ace-4d1d-9643-cd176502b592 client-request-id             :
0a355195-9d94-4db9-affe-53796d032726 x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:49 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:51  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : 33922ad0-5613-4aa3-be42-4e17481811c8 client-request-id             : c1eaac8d-54bf-4912-aae5-2900e97ed68c x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:51 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:51  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : 33922ad0-5613-4aa3-be42-4e17481811c8 client-request-id             :
c1eaac8d-54bf-4912-aae5-2900e97ed68c x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:51 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:52  Headers: Vary                          : Accept-Encoding Strict-Transport-Security     : max-age=31536000 request-id                    : 087b8b7e-024d-4f33-8b9d-5a0c6018c501 client-request-id             : 1cb7160c-3339-4d23-b078-d14cec9bea5e x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:52 GMT  

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
Get-MgUserAuthenticationMethod_List: Request Authorization failed  Status: 403 (Forbidden) ErrorCode: accessDenied Date: 2025-04-10T15:30:52  Headers: Vary                          : Accept-Encoding
Strict-Transport-Security     : max-age=31536000 request-id                    : 087b8b7e-024d-4f33-8b9d-5a0c6018c501 client-request-id             :
1cb7160c-3339-4d23-b078-d14cec9bea5e x-ms-ags-diagnostic           : {"ServerInfo":{"DataCenter":"South Africa
North","Slice":"E","Ring":"2","ScaleUnit":"002","RoleInstance":"JN3PEPF00000287"}} Date                          : Thu, 10 Apr 2025 15:30:52 GMT

  Recommendation: See service error codes: https://learn.microsoft.com/graph/errors
PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 101 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 102 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 102 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 102 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 102 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 102 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 102 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 102 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 102 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 102 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 103 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 104 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 104 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 104 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 104 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 104 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 104 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 104 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 104 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 104 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 105 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
**********************
PowerShell transcript end
End time: 20250410173433
**********************
**********************
PowerShell transcript start
Start time: 20250410173551
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 17:35:51] [INFO] Starting CSP Reporting process at 04/10/2025 17:35:51
[2025-04-10 17:35:51] [INFO] Processing tenant: Chartered Group
[2025-04-10 17:35:51] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 17:35:51] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 17:35:51] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 17:35:51] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 17:35:51] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 17:35:51] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 17:35:51] [INFO] Retrieving user count from tenant Chartered Group
[2025-04-10 17:35:51] [DEBUG] DEBUG: baseUrl = https://graph.microsoft.com/v1.0/users
[2025-04-10 17:35:51] [DEBUG] DEBUG: query = $count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 17:35:51] [DEBUG] DEBUG: userCountUrl = https://graph.microsoft.com/v1.0/users?$count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 17:35:51] [DEBUG] User count request URL: https://graph.microsoft.com/v1.0/users?$count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 17:35:51] [INFO] Found 355 users in tenant Chartered Group
PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 113 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 113 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 113 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 127 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 127 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 127 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 141 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 141 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 141 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(Write-Progress): "Cannot validate argument on parameter 'PercentComplete'. The 155 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again."
Write-Error: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 155 argument is greater than the maximum allowed range of 100. Supply an argument that is less than or equal to 100 and then try the command again.
Write-CSPProgress: Error in Write-CSPProgress: Cannot validate argument on parameter 'PercentComplete'. The 155 argument is greater than the maximum allowed range of 100. Supply an argument that is less
than or equal to 100 and then try the command again.

PS>TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
**********************
PowerShell transcript end
End time: 20250410174043
**********************
**********************
PowerShell transcript start
Start time: 20250410180011
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 18:00:11] [INFO] Starting CSP Reporting process at 04/10/2025 18:00:11
[2025-04-10 18:00:11] [INFO] Processing tenant: Chartered Group
[2025-04-10 18:00:11] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
PS>TerminatingError(ConvertTo-SecureString): "Cannot bind argument to parameter 'String' because it is an empty string."
[2025-04-10 18:00:11] [ERROR] Error processing tenant Chartered Group: Cannot bind argument to parameter 'String' because it is an empty string.

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, UserAuthenticationMethod.Read.All, Group.Read.All, Directory.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 18:00:11] [INFO] CSP Reporting process completed at 04/10/2025 18:00:11
**********************
PowerShell transcript end
End time: 20250410180011
**********************
**********************
PowerShell transcript start
Start time: 20250410180122
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 18:01:22] [INFO] Starting CSP Reporting process at 04/10/2025 18:01:22
[2025-04-10 18:01:22] [INFO] Processing tenant: Chartered Group
[2025-04-10 18:01:22] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 18:01:22] [DEBUG] TenantId: 83cf691f-ded3-4441-ad78-e4a088441fc0
[2025-04-10 18:01:22] [DEBUG] TenantName: Chartered Group
[2025-04-10 18:01:22] [DEBUG] AuthMethod: Certificate
[2025-04-10 18:01:22] [DEBUG] CertificatePath: .\Certificates\CSPauditCertPP.pfx
[2025-04-10 18:01:22] [DEBUG] CertificatePassword: D9)fnQ7C1*P5cd%B5D0)F1y,sB3O
[2025-04-10 18:01:22] [DEBUG] ClientSecret:
[2025-04-10 18:01:22] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 18:01:23] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 18:01:23] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 18:01:23] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 18:01:23] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 18:01:23] [DEBUG] User count request URL: https://graph.microsoft.com/v1.0/users?$count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 18:01:23] [INFO] Found 355 users in tenant Chartered Group
[2025-04-10 18:04:09] [INFO] MFA report for tenant Chartered Group completed. Processed 355 of 355 users.
[2025-04-10 18:04:09] [INFO] Successfully generated MFA report for tenant Chartered Group

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, UserAuthenticationMethod.Read.All, Group.Read.All, Directory.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 18:04:09] [INFO] CSP Reporting process completed at 04/10/2025 18:04:09
**********************
PowerShell transcript end
End time: 20250410180409
**********************
**********************
PowerShell transcript start
Start time: 20250410184111
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 18:41:12] [INFO] Starting CSP Reporting process at 04/10/2025 18:41:12
[2025-04-10 18:41:12] [INFO] Processing tenant: Chartered Group
[2025-04-10 18:41:12] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 18:41:12] [DEBUG] TenantId: 83cf691f-ded3-4441-ad78-e4a088441fc0
[2025-04-10 18:41:12] [DEBUG] TenantName: Chartered Group
[2025-04-10 18:41:12] [DEBUG] AuthMethod: Certificate
[2025-04-10 18:41:12] [DEBUG] CertificatePath: .\Certificates\CSPauditCertPP.pfx
[2025-04-10 18:41:12] [DEBUG] CertificatePassword: D9)fnQ7C1*P5cd%B5D0)F1y,sB3O
[2025-04-10 18:41:12] [DEBUG] ClientSecret:
[2025-04-10 18:41:12] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 18:41:12] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 18:41:12] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 18:41:12] [INFO] Generating MFA report for tenant Chartered Group...
[2025-04-10 18:41:12] [INFO] Generating MFA report for tenant Chartered Group
[2025-04-10 18:41:12] [DEBUG] User count request URL: https://graph.microsoft.com/v1.0/users?$count=true&$top=1&$filter=accountEnabled+eq+true
[2025-04-10 18:41:13] [INFO] Found 355 users in tenant Chartered Group
PS>TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
**********************
PowerShell transcript end
End time: 20250410184124
**********************
**********************
PowerShell transcript start
Start time: 20250410184324
Username: DESKTOP-FK2I144\louis
RunAs User: DESKTOP-FK2I144\louis
Configuration Name: 
Machine: DESKTOP-FK2I144 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -NoProfile -ExecutionPolicy Bypass -Command Import-Module 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules\PowerShellEditorServices\PowerShellEditorServices.psd1'; Start-EditorServices -HostName 'Visual Studio Code Host' -HostProfileId 'Microsoft.VSCode' -HostVersion '2025.0.0' -BundledModulesPath 'c:\Users\louis\.vscode\extensions\ms-vscode.powershell-2025.0.0\modules' -EnableConsoleRepl -StartupBanner "PowerShell Extension v2025.0.0
Copyright (c) Microsoft Corporation.

https://aka.ms/vscode-powershell
Type 'help' to get help.
" -LogLevel 'Warning' -LogPath 'c:\Users\louis\AppData\Roaming\Code\logs\20250410T130341\window2\exthost\ms-vscode.powershell' -SessionDetailsPath 'c:\Users\louis\AppData\Roaming\Code\User\globalStorage\ms-vscode.powershell\sessions\PSES-VSCode-36840-677047.json' -FeatureFlags @() 
Process ID: 34192
PSVersion: 7.5.0
PSEdition: Core
GitCommitId: 7.5.0
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
Transcript started, output file is .\Logs\CSPReporting.log
[2025-04-10 18:43:24] [INFO] Starting CSP Reporting process at 04/10/2025 18:43:24
[2025-04-10 18:43:24] [INFO] Processing tenant: Chartered Group
[2025-04-10 18:43:24] [DEBUG] Using ClientId: 09a8682e-8cf3-4960-aba2-377a056dc6ef
[2025-04-10 18:43:24] [DEBUG] TenantId: 83cf691f-ded3-4441-ad78-e4a088441fc0
[2025-04-10 18:43:24] [DEBUG] TenantName: Chartered Group
[2025-04-10 18:43:24] [DEBUG] AuthMethod: Certificate
[2025-04-10 18:43:24] [DEBUG] CertificatePath: .\Certificates\CSPauditCertPP.pfx
[2025-04-10 18:43:24] [DEBUG] CertificatePassword: D9)fnQ7C1*P5cd%B5D0)F1y,sB3O
[2025-04-10 18:43:24] [DEBUG] ClientSecret:
[2025-04-10 18:43:24] [DEBUG] Attempting authentication with Connect-CSPTenant...
VERBOSE: Connecting to tenant 83cf691f-ded3-4441-ad78-e4a088441fc0 using Certificate authentication
[2025-04-10 18:43:24] [DEBUG] Authentication with Connect-CSPTenant successful
[2025-04-10 18:43:24] [INFO] Successfully authenticated to tenant Chartered Group
[2025-04-10 18:43:24] [INFO] Generating DirectoryInfo report for tenant Chartered Group...
[2025-04-10 18:43:24] [ERROR] Error processing tenant Chartered Group: The term 'Get-CSPDirectoryReport' is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.

ClientId               : 09a8682e-8cf3-4960-aba2-377a056dc6ef
TenantId               : 83cf691f-ded3-4441-ad78-e4a088441fc0
Scopes                 : {Policy.Read.ConditionalAccess, UserAuthenticationMethod.Read.All, Group.Read.All, Directory.Read.All…}
AuthType               : AppOnly
TokenCredentialType    : ClientCertificate
CertificateThumbprint  : 
CertificateSubjectName : 
SendCertificateChain   : False
Account                : 
AppName                : Netsurit Reporting
ContextScope           : Process
Certificate            : [Subject]
                           CN=cspaudit.netsurit.com

                         [Issuer]
                           CN=cspaudit.netsurit.com

                         [Serial Number]
                           18E79363640B46B6BFE8B7A8D30F5978

                         [Not Before]
                           2025/04/02 10:07:21

                         [Not After]
                           2027/04/02 10:17:21

                         [Thumbprint]
                           1D38D5C4A9913CFF21F4AB6B6D3528998E4A6D99

PSHostVersion          : 2025.0.0
ManagedIdentityId      : 
ClientSecret           : 
Environment            : Global

True
[2025-04-10 18:43:24] [INFO] CSP Reporting process completed at 04/10/2025 18:43:24
**********************
PowerShell transcript end
End time: 20250410184324
**********************
